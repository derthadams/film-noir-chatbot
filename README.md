# Film Noir Chatbot
An NLP-based generative chatbot that speaks like a character from a classic 1940's Film Noir.

## Creating the chatbot
To create the chatbot I used a corpus of Film Noir screenplays to fine-tune Hugging Face's version
of Microsoft's DialoGPT NLP model.

Even though the training corpus was fairly small (10,000 lines of dialogue) the fine-tuned model 
has picked up quite a lot of Film Noir style and content. 
Conversations tend to veer towards themes of crime and betrayal, 
and the vocabulary contains quite a bit of 1940's slang. The chatbot has no concept of character, 
so it will sometimes abruptly shift personas between detective and femme fatale, or address the 
user with different names. 

The current model does tend to suffer from overfitting â€“ 
the chatbot will sometimes retrieve a memorized line of dialogue straight from a screenplay 
instead of coming up with a novel response. I plan to redo the fine-tuning using more data and a 
less-complex base model in order to address this problem.

## App design

To complete the project, I set up a Flask application that runs the NLP model and exposes a 
Rest API. My frontend, which I wrote in React, uses the API to send messages from the user to the 
model and get the responses back. The frontend also uses SQLite database to enable the user to 
save chats and load them again later.

I thought the user interface should be as simple as possible, and really focus the user on the 
chat experience itself. Ideally I wanted the conversation with the bot to be the interface, not 
the text and buttons on the screen.

## Initial prompts

When the app first loads the chat window is already active, and the user can just jump in and 
start chatting. But if the user hesitates for more than 10 seconds, the bot takes the initiative 
and starts talking to the user.

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166334516-f6182014-f681-4034-b1bd-748c2eb4f213.gif" width="680" alt="Chatbot prompts">

</div>


These messages aren't generated by the model, they're a pre-scripted sequence designed to 
invite the user into the experience. The longer the user goes without typing anything, the more 
specific the prompts get. As soon as the user starts typing, the sequence ends and the model takes 
over the conversation.

## Save and Load Chats

The user can save the current chat, view their saved chats, and load saved chats into the current
chat window in case they want to resume the conversation. The saved chat dialogue is loaded into
the model as well as the frontend UI, so that the chatbot is aware of the context of the
conversation and can pick up where it left off.

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166344202-e3d3fa01-6790-4f97-90dc-81a59b5cc405.gif" width="680" alt="Save and load chats">

</div>

## Demo Chat Recordings

[comment]: <> (### Beers, please)

[comment]: <> (<div align="center">)

[comment]: <> (<img src="https://user-images.githubusercontent.com/39425112/166334851-96808814-7a26-4c57-a392-7222c983cda9.gif" width="680" alt="Beers">)

[comment]: <> (</div>)
### "You'll have to solve that mystery for yourself"

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166339173-b8af84ff-0ec8-4951-a336-dd0270660350.gif" width="680" alt="Solve yourself">

</div>

### "How fast is he going?"

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166338720-87e2daf3-3732-4b5b-99c2-1b3e1197a40c.gif" width="680" alt="How fast is he going?">

</div>
