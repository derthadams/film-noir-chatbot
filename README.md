# Film Noir Chatbot
A generative chatbot that speaks like a character from a classic 1940's Film Noir.

## Creating the chatbot
To create the chatbot I fine-tuned Microsoft's DialoGPT-2 NLP model with a corpus of Film Noir
screenplays. I prepared the training data by stripping everything but the dialogue from the 
screenplays and creating a CSV file with one line of dialogue per row. Then I generated training
examples using a sliding window that was eight lines long. During training the model looked at 
each eight-line window and learned how to predict the last line of dialogue in the window 
based on the previous seven lines.

When chatting with the bot you can tell that the fine-tuned model has picked up a lot of the 
Film Noir style and content. Conversations inevitably veer towards themes of crime and betrayal, 
and the vocabulary contains quite a bit of 1940's slang. The chatbot has no concept of character, 
so it will sometimes abruptly shift personas between detective and femme fatale, or address the 
user with different names. 

The current model does tend to suffer from overfitting â€“ 
the chatbot will sometimes regurgitate a memorized line of dialogue straight from a screenplay 
instead of coming up with a novel response. I plan to redo the fine-tuning using more data and a 
less-complex base model in order to address this problem.

## App design

To complete the project, I set up a Flask application that runs the NLP model and exposes a 
Rest API. My frontend, which I wrote in React, uses the API to send messages from the user to the 
model and get the responses back. The frontend also uses SQLite database to enable the user to 
save chats and load them again later.

## Initial prompts

I thought the user interface should be as simple as possible, and really focus the user on the 
chat experience itself. Ideally I wanted the conversation with the bot to be the interface, not 
the text and buttons on the screen.

When the app first loads the chat window is already active, and the user can just jump in and 
start chatting. But if the user hesitates for more than 10 seconds, the bot takes the initiative 
and starts talking to the user.

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166334516-f6182014-f681-4034-b1bd-748c2eb4f213.gif" width="680" alt="Chatbot prompts">

</div>


These messages aren't generated by the model, they're a pre-scripted sequence designed to 
invite the user into the experience. The longer the user goes without typing anything, the more 
specific the prompts get. As soon as the user starts typing, the sequence ends and the model takes 
over the conversation.

## Save and Load Chats

The user can save the current chat, view their saved chats, and load saved chats into the current
chat window in case they want to resume the conversation. The saved chat dialogue is loaded into
the model as well as the frontend UI, so that the chatbot is aware of the context of the
conversation and can pick up where it left off.

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166335390-ff9d696f-3c1b-44fc-b7a3-201150b649b5.gif" width="680" alt="Save and load chats">

</div>

## Demo Chat Recordings

[comment]: <> (### Beers, please)

[comment]: <> (<div align="center">)

[comment]: <> (<img src="https://user-images.githubusercontent.com/39425112/166334851-96808814-7a26-4c57-a392-7222c983cda9.gif" width="680" alt="Beers">)

[comment]: <> (</div>)
### "You'll have to solve that mystery for yourself"

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166339173-b8af84ff-0ec8-4951-a336-dd0270660350.gif" width="680" alt="Solve yourself">

</div>

### "How fast is he going?"

<div align="center">

<img src="https://user-images.githubusercontent.com/39425112/166338720-87e2daf3-3732-4b5b-99c2-1b3e1197a40c.gif" width="680" alt="How fast is he going?">

</div>
